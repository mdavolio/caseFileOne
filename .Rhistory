setwd("~/Fall 2016/STAT 6021/Homework")
library(readxl)
library(MASS)
library(MPV)
table.b1 <- read_excel('data-table-b1.xls')
nfl.lm <- lm(y ~ x2 + x7 + x8, data = table.b1)
# Part A
qqnorm(rstandard(nfl.lm))
qqline(rstandard(nfl.lm))
e <- resid(nfl.lm)
y_hat <- predict(nfl.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values')
plot(table.b1$x2, e, ylab = 'Residuals', xlab = 'X2')
plot(table.b1$x7, e, ylab = 'Residuals', xlab = 'X7')
plot(table.b1$x8, e, ylab = 'Residuals', xlab = 'X8')
plot(table.b1$x2, e, ylab = 'Residuals', xlab = 'X2')
plot(table.b1$x7, e, ylab = 'Residuals', xlab = 'X7')
plot(table.b1$x8, e, ylab = 'Residuals', xlab = 'X8')
x2.lm <- lm(y ~ x7 + x8, data = table.b1)
ex2 <- resid(x2.lm)
x22.lm <- lm(x2 ~ x7 + x8, data = table.b1)
ex22 <- resid(x22.lm)
plot(ex22, ex2)
x7.lm <- lm(y ~ x2 + x8, data = table.b1)
ex7 <- resid(x7.lm)
x77.lm <- lm(x7 ~ x2 + x8, data = table.b1)
ex77 <- resid(x77.lm)
plot(ex77, ex7)
x8.lm <- lm(y ~ x2 + x7, data = table.b1)
ex8 <- resid(x8.lm)
x88.lm <- lm(x8 ~ x2 + x7, data = table.b1)
ex88 <- resid(x8.lm)
plot(ex88, ex8)
x2.lm <- lm(y ~ x7 + x8, data = table.b1)
ex2 <- resid(x2.lm)
x22.lm <- lm(x2 ~ x7 + x8, data = table.b1)
ex22 <- resid(x22.lm)
plot(ex22, ex2)
rstudent(nfl.lm)
studres(nfl.lm)
print(abs(rstudent(nfl.lm)) > 2)
table.b3 <- read_excel('data-table-b3.xls')
gasMile.lm <- lm(y ~ x1 + x6, data = table.b3)
qqnorm(rstandard(gasMile.lm))
qqline(rstandard(gasMile.lm))
e <- resid(gasMile.lm)
y_hat <- predict(gasMile.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values')
mean(e)
# zero.
# Part C
x1.lm <- lm(y ~ x6, data = table.b3)
ex1 <- resid(x1.lm)
x1.lm2 <- lm(x1 ~ x6, data = table.b3)
ex1.2 <- resid(x1.lm2)
plot(ex1.2, ex1)
x6.lm <- lm(y ~ x1, data = table.b3)
ex6 <- resid(x6.lm)
x6.lm2 <- lm(x6 ~ x1, data = table.b3)
ex6.2 <- resid(x6.lm2)
plot(ex6.2, ex6)
# variable to include in the model
# Part D
rstud <- rstudent(gasMile.lm)
studres(gasMile.lm)
print(abs(rstud) > 2)
rstudent(gasMile.lm)
studres(gasMile.lm)
print(abs(rstud) > 2)
rstud
studres(gasMile.lm)
print(abs(rstud) > 2)
# relatively high
# Problem 4.8
data("p2.12")
attach(p2.12)
steam.lm <- lm(usage ~ temp)
qqnorm(rstandard(steam.lm))
qqline(rstandard(steam.lm))
e <- resid(steam.lm)
y_hat <- predict(steam.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values')
# There appears to be some pattern within the residuals and therefore the data may be nonlinear
# Part C
plot(e)
plot(e)
table.b5 <- read_excel('data-table-b5.xls')
co2Prod.lm <- lm(y ~ x6 + x7, data = table.b5)
co2Prod2.lm <- lm(y ~ x6, data = table.b5)
qqnorm(rstandard(co2Prod.lm))
qqline(rstandard(co2Prod.lm))
qqnorm(rstandard(co2Prod2.lm))
qqline(rstandard(co2Prod2.lm))
resid1 <- resid(co2Prod.lm)
sum((resid1 / (1-lm.influence(co2Prod.lm)$hat))^2)
resid2 <- resid(co2Prod2.lm)
sum((resid2 / (1-lm.influence(co2Prod2.lm)$hat))^2)
table.b16 <- read_excel('data-table-b16.xls')
lifeExp.lm <- lm(LifeExp ~ `People-per-TV` + `People-per-Dr`, data = table.b16)
lifeExpMale.lm <- lm(LifeExpMale ~ `People-per-TV` + `People-per-Dr`, data = table.b16)
lifeExpFemale.lm <- lm(LifeExpFemale ~ `People-per-TV` + `People-per-Dr`, data = table.b16)
qqline(rstandard(lifeExp.lm))
qqnorm(rstandard(lifeExp.lm))
qqline(rstandard(lifeExp.lm))
qqnorm(rstandard(lifeExpMale.lm))
qqline(rstandard(lifeExpMale.lm))
qqnorm(rstandard(lifeExpFemale.lm))
qqline(rstandard(lifeExpFemale.lm))
qqnorm(rstandard(lifeExp.lm))
qqline(rstandard(lifeExp.lm))
qqnorm(rstandard(lifeExpMale.lm))
qqline(rstandard(lifeExpMale.lm))
qqnorm(rstandard(lifeExpFemale.lm))
qqline(rstandard(lifeExpFemale.lm))
# ends of the plots
# Part B
e <- resid(lifeExp.lm)
y_hat <- predict(lifeExp.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'LifeExp')
e <- resid(lifeExpMale.lm)
y_hat <- predict(lifeExpMale.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'LifeExpMale')
e <- resid(lifeExpFemale.lm)
y_hat <- predict(lifeExpFemale.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'LifeExpFemale')
table.b20 <- read.csv('B20.csv')
methOx.lm <- lm(y ~ ., data = table.b20)
qqnorm(rstandard(methOx.lm))
qqline(rstandard(methOx.lm))
e <- resid(methOx.lm)
y_hat <- predict(methOx.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
# results which may indicate it is a nonlinear data set
# Problem 5.2
data('p5.2')
table5.2 <- p5.2
# Part A
plot(table5.2)
vapor.lm <- lm(vapor ~ temp, data = table5.2)
summary(vapor.lm)
summary(table5.2)
qqnorm(rstandard(vapor.lm))
qqline(rstandard(vapor.lm))
e <- resid(vapor.lm)
y_hat <- predict(vapor.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Vapor Pressure')
# The residual plots further emphasize that the data is nonlinear
# Part C
boxcox(vapor.lm)
vaporCC.lm <- lm(log(vapor) ~ -1/temp, data = table5.2)
summary(vaporCC.lm)
qqnorm(rstandard(vaporCC.lm))
qqline(rstandard(vaporCC.lm))
e <- resid(vaporCC.lm)
y_hat <- predict(vaporCC.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Vapor Pressure')
y_hat <- predict(vaporCC.lm)
qqnorm(rstandard(vaporCC.lm))
# be linear
data(p5.5)
table5.5 <- p5.5
defects.lm <- lm(defects ~ weeks, data = table5.5)
qqnorm(rstandard(defects.lm))
qqline(rstandard(defects.lm))
e <- resid(defects.lm)
y_hat <- predict(defects.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Defects per 10,000')
qqnorm(rstandard(defects.lm))
qqline(rstandard(defects.lm))
e <- resid(defects.lm)
y_hat <- predict(defects.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Defects per 10,000')
plot(table5.5)
boxcox(defects.lm)
defects.lm2 <- lm(log(defects) ~ weeks, data = table5.5)
qqnorm(rstandard(defects.lm2))
qqline(rstandard(defects.lm2))
e <- resid(defects.lm2)
y_hat <- predict(defects.lm2)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Defects per 10,000')
# be more linear
# Problem 5.7
methOx.lm <- lm(y ~ ., data = table.b20)plot(methOx.lm)
methOx.lm <- lm(y ~ ., data = table.b20)
plot(methOx.lm)
qqnorm(rstandard(methOx.lm))
qqline(rstandard(methOx.lm))
e <- resid(methOx.lm)
y_hat <- predict(methOx.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
boxcox(methOx.lm)
methOx.lm2 <- lm(log(y) ~ ., data = table.b20)
qqnorm(rstandard(methOx.lm2))
qqline(rstandard(methOx.lm2))
e <- resid(methOx.lm2)
y_hat <- predict(methOx.lm2)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
table.b20 <- read.csv('B20.csv')
methOx.lm <- lm(y ~ ., data = table.b20)
qqnorm(rstandard(methOx.lm))
qqline(rstandard(methOx.lm))
e <- resid(methOx.lm)
y_hat <- predict(methOx.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
summary(methOx.lm)
methOx2.lm <- lm(y ~ . -x_4 -x_5, data = table.b20)
methOx2.lm
summary(methOx2.lm)
methOx.lm2 <- lm(y ~ . -x_4 -x_5, data = table.b20)
# based off the reults from 4.29, we remove the variables x4 and x5 to create a new model
qqnorm(rstandard(methOx.lm2))
qqline(rstandard(methOx.lm2))
e <- resid(methOx.lm2)
y_hat <- predict(methOx.lm2)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
boxcox(methOx.lm2)
methOx.lm3 <- lm(log(y) ~ . -x_4 -x_5, data = table.b20)
qqnorm(rstandard(methOx.lm3))
qqline(rstandard(methOx.lm3))
e <- resid(methOx.lm3)
y_hat <- predict(methOx.lm3)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
rstudent(methOx.lm3)
data(table.b8)
clathrate.lm <- lm(y ~ ., data = table.b8)
qqnorm(rstandard(clathrate.lm))
qqline(rstandard(clathrate.lm))
e <- resid(clathrate.lm)
y_hat <- predict(clathrate.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
boxcox(clathrate.lm)
# Since the confidence Interval contains 1, we will not perform a transformation on the data
# Problem 5.10
data(table.b9)
# Part A
pressure.lm <- lm(y ~ ., data = table.b9)
qqnorm(rstandard(pressure.lm))
qqline(rstandard(pressure.lm))
e <- resid(pressure.lm)
y_hat <- predict(pressure.lm)
plot(y_hat, e, ylab = 'Residuals', xlab = 'Predicted Values', main = 'Methanol Oxidation')
boxcox(pressure.lm)
library(readr)
library(readxl)
library(maptools)
library(RColorBrewer)
library(MASS)
library(dplyr)
library(rgdal)
crime2016 <- read_csv('DataSets/Crime_Incidents__2016.csv')
crime2015 <- read_csv('DataSets/Crime_Incidents__2015.csv')
crime2014 <- read_csv('DataSets/Crime_Incidents__2014.csv')
crime2013 <- read_csv('DataSets/Crime_Incidents__2013.csv')
crime2012 <- read_csv('DataSets/Crime_Incidents__2012.csv')
crime2011 <- read_csv('DataSets/Crime_Incidents__2011.csv')
streetCams <- read_csv('DataSets/CCTV__Street_Cameras.csv')
policeStations <- read_csv('DataSets/Police_Stations.csv')
wardDemo <- read_csv('DataSets/wardDemographics.csv')
wardWellBeing <- read_csv('DataSets/wardWellBeing.csv')
metroBus <- read_csv('DataSets/Metro_Bus_Stops.csv')
metroStations <- read_csv('DataSets/Metro_Stations_Regional.csv')
setwd("~/Fall 2016/SYS 6018/caseFileOne")
crime2016 <- read_csv('DataSets/Crime_Incidents__2016.csv')
crime2015 <- read_csv('DataSets/Crime_Incidents__2015.csv')
crime2014 <- read_csv('DataSets/Crime_Incidents__2014.csv')
crime2013 <- read_csv('DataSets/Crime_Incidents__2013.csv')
crime2012 <- read_csv('DataSets/Crime_Incidents__2012.csv')
crime2011 <- read_csv('DataSets/Crime_Incidents__2011.csv')
streetCams <- read_csv('DataSets/CCTV__Street_Cameras.csv')
policeStations <- read_csv('DataSets/Police_Stations.csv')
wardDemo <- read_csv('DataSets/wardDemographics.csv')
wardWellBeing <- read_csv('DataSets/wardWellBeing.csv')
metroBus <- read_csv('DataSets/Metro_Bus_Stops.csv')
metroStations <- read_csv('DataSets/Metro_Stations_Regional.csv')
dsn <-"/Ward__2012"
shapefile <- "Ward__2012"
dc<- readOGR(dsn,layer = shapefile)
dsn <-"Ward__2012"
shapefile <- "Ward__2012"
dc<- readOGR(dsn,layer = shapefile)
summary(dc)
plot(dc)
crswgs84=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
wgs<-"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"
sp <- spTransform(dc, crswgs84)
# get color palette for heat map
palette.function = colorRampPalette(rev(brewer.pal(11,'Spectral')))
crswgs84=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
wgs<-"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0"
sp <- spTransform(dc, crswgs84)
est = kde2d(crime2016Loc[,'X'], crime2016Loc[,'Y'], h=0.1, n=c(100,100))  # h=0.1
image(est, col = heat.colors, useRaster=TRUE, asp=1)
palette.function = colorRampPalette(rev(brewer.pal(11,'Spectral')))
heat.colors = palette.function(32)
# Crime Locations 2016
names(crime2016)[1]<-paste("X")
crime2016Loc <- as.data.frame(subset(crime2016, select = c('X','Y')))
# Plot Crime KDE
est = kde2d(crime2016Loc[,'X'], crime2016Loc[,'Y'], h=0.1, n=c(100,100))  # h=0.1
image(est, col = heat.colors, useRaster=TRUE, asp=1)
plot(dc, add = T)
crime2016
View(crime2016)
